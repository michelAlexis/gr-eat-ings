generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["referentialIntegrity", "fullTextSearch", "fullTextIndex"]
}

datasource db {
  provider             = "mysql"
  url                  = env("DATABASE_URL")
  shadowDatabaseUrl    = env("DATABASE_URL_SHADOW")
  referentialIntegrity = "prisma"
}

enum IngredientUnit {
  unique
  gr
  kg
  ml
  l
}

model Ingredient {
  id                 String               @id @default(cuid())
  // Properties
  name               String               @db.VarChar(100)
  quantityRef        Int
  unitRef            IngredientUnit
  // Nutrition
  kcal               Int?
  fat                Float?
  fatSaturated       Float?
  carb               Float?
  sugar              Float?
  fiber              Float?
  protein            Float?
  salt               Float?
  // Ingredients
  IngredientQuantity IngredientQuantity[]
  // audit
  createdAt          DateTime             @default(now())
  updatedAt          DateTime             @updatedAt

  @@fulltext([name])
}

model Recipe {
  id                 String               @id @default(cuid())
  // Properties
  name               String               @db.VarChar(100)
  sizeReference      Int
  // audit
  createdAt          DateTime             @default(now())
  updatedAt          DateTime             @updatedAt
  IngredientQuantity IngredientQuantity[]
}

model IngredientQuantity {
  id           String         @id @default(cuid())
  // Recipe
  recipeId     String
  recipe       Recipe         @relation(fields: [recipeId], references: [id])
  // Ingredient
  ingredientId String
  ingredient   Ingredient     @relation(fields: [ingredientId], references: [id])
  // Properties
  quantity     Float          @db.Float
  unit         IngredientUnit
  // audit
  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt

  @@unique([recipeId, ingredientId])
}
